(()=>{var e={};e.id=58,e.ids=[58],e.modules={643:e=>{"use strict";e.exports=require("node:perf_hooks")},1708:e=>{"use strict";e.exports=require("node:process")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:e=>{"use strict";e.exports=require("node:buffer")},7252:e=>{"use strict";e.exports=require("express")},10411:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{"4003af2b6978aee3907a67d9849ac90c92cbd7575c":()=>i.T,"4009aad1f8b392364694d77d5e9bb97a4a714cbbb9":()=>n.P,"4021e8d75d579c67e7280e1e9c68558336e65fa1cd":()=>a.A});var i=r(26174),a=r(73200),n=r(76973),o=e([i,a,n]);[i,a,n]=o.then?(await o)():o,s()}catch(e){s(e)}})},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},14985:e=>{"use strict";e.exports=require("dns")},15193:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>_});var s=r(60687),i=r(43210),a=r(17639),n=r(44493),o=r(29523),c=r(3662),l=r(97025),d=r(11516),u=r(78748),p=r(43619),m=r(77368),h=r(29867),x=r(6475);let f=(0,x.createServerReference)("4021e8d75d579c67e7280e1e9c68558336e65fa1cd",x.callServer,void 0,x.findSourceMapURL,"generatePracticeQuestions");var g=r(41118),b=r(85726),w=r(23562),y=r(50812),j=r(80013),v=r(34729),q=r(89667),k=r(4780),N=r(85814),z=r.n(N),A=r(91821),T=r(51617),S=r(56896),C=r(8802);function P({question:e,onAnswered:t}){let[r,a]=(0,i.useState)(""),[p,m]=(0,i.useState)(!1),[h,x]=(0,i.useState)(!1),[f,b]=(0,i.useState)(null),w=async()=>{if(m(!0),"multiple-choice"===e.quizType)t(+(r===e.answer));else if("fill-in-the-gaps"===e.quizType){let s=r.trim().toLowerCase();t(+(s===e.answer.trim().toLowerCase()))}else if("written-question"===e.quizType){x(!0);try{let s=await (0,g.P)({question:e.question,marks:e.marks,userAnswer:r,markScheme:e.answer});b(s),t(s.marksAwarded)}catch(e){console.error("AI grading failed",e),t(0)}finally{x(!1)}}},N=()=>"multiple-choice"===e.quizType||"fill-in-the-gaps"===e.quizType||"written-question"===e.quizType?e.answer:"",z=()=>!!p&&("fill-in-the-gaps"===e.quizType?r.trim().toLowerCase()===e.answer.trim().toLowerCase():r===N());return(0,s.jsxs)("div",{className:"space-y-4",children:[(()=>{switch(e.quizType){case"multiple-choice":return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-lg font-semibold",children:e.question}),(0,s.jsx)(y.z,{value:r,onValueChange:a,disabled:p,children:e.options.map(t=>{let i=e.answer===t,a=r===t;return(0,s.jsxs)(j.J,{className:(0,k.cn)("flex items-center space-x-3 p-3 border rounded-md transition-colors","cursor-pointer hover:bg-muted",p&&i&&"border-green-500 bg-green-100 dark:bg-green-900/30",p&&!i&&a&&"border-red-500 bg-red-100 dark:bg-red-900/30"),children:[(0,s.jsx)(y.C,{value:t}),(0,s.jsx)("span",{children:t}),p&&i&&(0,s.jsx)(c.A,{className:"ml-auto h-5 w-5 text-green-600"}),p&&!i&&a&&(0,s.jsx)(l.A,{className:"ml-auto h-5 w-5 text-red-600"})]},t)})})]});case"written-question":return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("p",{className:"text-lg font-semibold",children:[e.question," ",(0,s.jsxs)("span",{className:"font-bold text-muted-foreground",children:["[",e.marks," marks]"]})]}),(0,s.jsx)(v.T,{placeholder:"Your answer...",value:r,onChange:e=>a(e.target.value),rows:6,disabled:p}),h&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,s.jsx)(d.A,{className:"h-4 w-4 animate-spin"}),(0,s.jsx)("p",{children:"AI is marking your answer..."})]}),f?(0,s.jsxs)(n.Zp,{className:"mt-4 border-border",children:[(0,s.jsx)(n.aR,{children:(0,s.jsxs)(n.ZB,{className:"flex items-center",children:[(0,s.jsx)(u.A,{className:"h-5 w-5 mr-2 text-primary"}),"AI Feedback: ",f.marksAwarded," / ",e.marks," ","marks"]})}),(0,s.jsx)(n.Wu,{className:"prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:f.feedback}})]}):p&&(0,s.jsxs)(A.Fc,{children:[(0,s.jsx)(A.XL,{children:"Model Answer"}),(0,s.jsx)(A.TN,{children:N()})]})]});case"fill-in-the-gaps":let t=z();return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"flex items-center gap-2 flex-wrap text-lg",children:e.sentence.split("______").map((e,t,i)=>(0,s.jsxs)("span",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:e}),t<i.length-1&&(0,s.jsx)(q.p,{type:"text",className:"h-8 w-32",value:r,onChange:e=>a(e.target.value),disabled:p})]},t))}),p&&(0,s.jsxs)(A.Fc,{className:(0,k.cn)(t?"border-green-500":"border-red-500"),children:[t?(0,s.jsx)(c.A,{className:"h-4 w-4"}):(0,s.jsx)(l.A,{className:"h-4 w-4"}),(0,s.jsx)(A.XL,{children:t?"Correct!":"Incorrect"}),(0,s.jsxs)(A.TN,{children:["The correct answer was: ",(0,s.jsx)("strong",{children:N()})]})]})]});default:return(0,s.jsx)("p",{children:"Unsupported question type"})}})(),(0,s.jsx)("div",{className:"flex justify-end",children:!p&&(0,s.jsx)(o.$,{onClick:w,disabled:!r||h,children:h?(0,s.jsx)(d.A,{className:"mr-2 h-4 w-4 animate-spin"}):"Check Answer"})})]})}function _(){let[e,t]=(0,i.useState)([]),[r,c]=(0,i.useState)(!1),[l,u]=(0,i.useState)([]),[x,g]=(0,i.useState)(0),[y,v]=(0,i.useState)(0),[q,k]=(0,i.useState)(0),[N,A]=(0,i.useState)(!1),[_,E]=(0,i.useState)(!1),[R,F]=(0,i.useState)(!1),{toast:L}=(0,h.dj)(),M=async()=>{if(0===e.length)return void L({variant:"destructive",title:"No topics selected",description:"Please select at least one topic to start the exam."});c(!0),E(!0);try{let t=await f({topic:e.join(", "),difficulty:"medium",performanceSummary:`The user wants a practice exam based on these specific topics: ${e.join(", ")}.`,questionCount:10});u(t.questions),k(t.questions.reduce((e,t)=>e+("written-question"===t.quizType?t.marks:1),0))}catch(e){console.error(e),L({variant:"destructive",title:"Error generating exam",description:"Could not create a practice exam. Please try again."}),E(!1)}finally{c(!1)}},B=()=>{F(!1),x<l.length-1?g(e=>e+1):A(!0)},G=e=>{v(t=>t+e),F(!0)},Y=()=>{A(!1),v(0),k(0),g(0),u([]),E(!1),t([])},I=(e,r)=>{t(t=>r?[...t,e]:t.filter(t=>t!==e))};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.z,{title:"Practice Exam",description:"An AI-generated mock exam focused on your chosen topics."}),(()=>{if(r&&!_)return(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)(d.A,{className:"h-8 w-8 animate-spin mx-auto"})});if(!_)return(0,s.jsxs)(n.Zp,{children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsx)(n.ZB,{children:"Practice Exam Setup"}),(0,s.jsx)(n.BT,{children:"Choose your topics to generate a personalized exam."})]}),(0,s.jsxs)(n.Wu,{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h3",{className:"font-semibold",children:"Select Topics"}),(0,s.jsx)(C.nD,{type:"multiple",className:"w-full",children:T.yo.map(t=>(0,s.jsxs)(C.As,{value:t.id,children:[(0,s.jsx)(C.$m,{className:"font-bold",children:t.name}),(0,s.jsx)(C.ub,{children:(0,s.jsx)("div",{className:"space-y-2 pl-4",children:t.topics.map(t=>(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(j.J,{className:"flex items-start space-x-2 p-2 rounded-md hover:bg-muted transition-colors",children:[(0,s.jsx)(S.S,{id:t.id,checked:e.includes(t.title),onCheckedChange:e=>I(t.title,!!e)}),(0,s.jsx)("div",{className:"grid gap-1.5 leading-none",children:(0,s.jsx)("span",{className:"font-semibold text-sm",children:t.title})})]}),t.subTopics&&(0,s.jsx)("div",{className:"pl-6 space-y-2",children:t.subTopics.map(t=>(0,s.jsxs)(j.J,{className:"flex items-start space-x-2 p-2 rounded-md hover:bg-muted/50 transition-colors",children:[(0,s.jsx)(S.S,{id:t.id,checked:e.includes(t.title),onCheckedChange:e=>I(t.title,!!e)}),(0,s.jsx)("div",{className:"grid gap-1.5 leading-none",children:(0,s.jsx)("span",{className:"font-medium text-xs",children:t.title})})]},t.id))})]},t.id))})})]},t.id))})]}),(0,s.jsx)(o.$,{onClick:M,disabled:0===e.length,children:"Start Exam"})]})]});if(r&&_)return(0,s.jsxs)(n.Zp,{children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsx)(n.ZB,{children:"Generating Your Exam Paper..."}),(0,s.jsx)(n.BT,{children:"The AI is creating a personalized paper just for you. This might take a moment."})]}),(0,s.jsx)(n.Wu,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(b.E,{className:"h-6 w-3/4"}),(0,s.jsx)(b.E,{className:"h-10 w-full"}),(0,s.jsx)(b.E,{className:"h-10 w-full"})]})})]});if(N){let e=q>0?Math.round(y/q*100):0;return(0,s.jsx)("div",{className:"flex flex-col items-center justify-center text-center h-full",children:(0,s.jsxs)(n.Zp,{className:"w-full max-w-md",children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsx)(p.A,{className:"mx-auto h-16 w-16 text-yellow-500"}),(0,s.jsx)(n.ZB,{className:"mt-4 text-2xl",children:"Exam Complete!"}),(0,s.jsx)(n.BT,{children:"Great work tackling your selected topics."})]}),(0,s.jsxs)(n.Wu,{children:[(0,s.jsxs)("p",{className:"text-4xl font-bold",children:[y," / ",q]}),(0,s.jsxs)("p",{className:"text-lg text-muted-foreground mt-1",children:["That's ",e,"%"]}),(0,s.jsxs)("div",{className:"flex gap-4 mt-6 justify-center",children:[(0,s.jsxs)(o.$,{onClick:Y,children:[(0,s.jsx)(m.A,{className:"mr-2 h-4 w-4"}),"Try Another Exam"]}),(0,s.jsx)(z(),{href:"/dashboard",passHref:!0,children:(0,s.jsx)(o.$,{variant:"outline",children:"Back to Dashboard"})})]})]})]})})}if(l.length>0){let e=l[x];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(w.k,{value:(x+1)/l.length*100,className:"mb-4"}),(0,s.jsxs)(n.Zp,{children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsxs)(n.ZB,{children:["Question ",x+1," of ",l.length]}),(0,s.jsx)(n.BT,{className:"text-sm pt-2 capitalize font-semibold text-primary",children:e.quizType.replace(/-/g," ")})]}),(0,s.jsxs)(n.Wu,{children:[(0,s.jsx)(P,{question:e,onAnswered:G},x),R&&(0,s.jsx)("div",{className:"flex justify-end mt-4",children:(0,s.jsx)(o.$,{onClick:B,children:x===l.length-1?"Finish Exam":"Next Question"})})]})]})]})}return null})()]})}},16141:e=>{"use strict";e.exports=require("node:zlib")},16698:e=>{"use strict";e.exports=require("node:async_hooks")},19063:e=>{"use strict";e.exports=require("require-in-the-middle")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19185:e=>{"use strict";e.exports=require("dgram")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},23562:(e,t,r)=>{"use strict";r.d(t,{k:()=>o});var s=r(60687),i=r(43210),a=r(25177),n=r(4780);let o=i.forwardRef(({className:e,value:t,...r},i)=>(0,s.jsx)(a.bL,{ref:i,className:(0,n.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...r,children:(0,s.jsx)(a.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));o.displayName=a.bL.displayName},26428:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/workspaces/Niyyro3.github.io/src/app/practice-exam/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/workspaces/Niyyro3.github.io/src/app/practice-exam/page.tsx","default")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},37046:(e,t,r)=>{Promise.resolve().then(r.bind(r,15193))},37067:e=>{"use strict";e.exports=require("node:http")},37830:e=>{"use strict";e.exports=require("node:stream/web")},40608:e=>{"use strict";e.exports=import("@genkit-ai/google-genai")},41118:(e,t,r)=>{"use strict";r.d(t,{P:()=>i});var s=r(6475);let i=(0,s.createServerReference)("4009aad1f8b392364694d77d5e9bb97a4a714cbbb9",s.callServer,void 0,s.findSourceMapURL,"gradeWrittenAnswer")},44708:e=>{"use strict";e.exports=require("node:https")},50812:(e,t,r)=>{"use strict";r.d(t,{C:()=>l,z:()=>c});var s=r(60687),i=r(43210),a=r(14555),n=r(73256),o=r(4780);let c=i.forwardRef(({className:e,...t},r)=>(0,s.jsx)(a.bL,{className:(0,o.cn)("grid gap-2",e),...t,ref:r}));c.displayName=a.bL.displayName;let l=i.forwardRef(({className:e,...t},r)=>(0,s.jsx)(a.q7,{ref:r,className:(0,o.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:(0,s.jsx)(a.C1,{className:"flex items-center justify-center",children:(0,s.jsx)(n.A,{className:"h-2.5 w-2.5 fill-current text-current"})})}));l.displayName=a.q7.displayName},54379:e=>{"use strict";e.exports=require("node:path")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},56801:e=>{"use strict";e.exports=require("import-in-the-middle")},56896:(e,t,r)=>{"use strict";r.d(t,{S:()=>c});var s=r(60687),i=r(43210),a=r(40211),n=r(58450),o=r(4780);let c=i.forwardRef(({className:e,...t},r)=>(0,s.jsx)(a.bL,{ref:r,className:(0,o.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:(0,s.jsx)(a.C1,{className:(0,o.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(n.A,{className:"h-4 w-4"})})}));c.displayName=a.bL.displayName},57075:e=>{"use strict";e.exports=require("node:stream")},57493:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>l});var s=r(65239),i=r(48088),a=r(88170),n=r.n(a),o=r(30893),c={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);r.d(t,c);let l={children:["",{children:["practice-exam",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,26428)),"/workspaces/Niyyro3.github.io/src/app/practice-exam/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,3439)),"/workspaces/Niyyro3.github.io/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["/workspaces/Niyyro3.github.io/src/app/practice-exam/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/practice-exam/page",pathname:"/practice-exam",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},57975:e=>{"use strict";e.exports=require("node:util")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73024:e=>{"use strict";e.exports=require("node:fs")},73136:e=>{"use strict";e.exports=require("node:url")},73200:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{A:()=>l});var i=r(91199);r(42087);var a=r(95427),n=r(37612),o=r(33331),c=e([a]);a=(c.then?(await c)():c)[0];let d=n.z.object({quizType:n.z.enum(["multiple-choice"]),question:n.z.string().describe("The question text."),options:n.z.array(n.z.string()).describe("An array of 4 possible answers."),answer:n.z.string().describe("The correct answer from the options array.")}),u=n.z.object({quizType:n.z.enum(["written-question"]),question:n.z.string().describe("The open-ended exam-style question."),marks:n.z.number().min(1).max(6).describe("The number of marks the question is worth (1-6)."),answer:n.z.string().describe("A concise, ideal answer to the question that can be used for checking.")}),p=n.z.object({quizType:n.z.enum(["fill-in-the-gaps"]),sentence:n.z.string().describe('A sentence with a key term replaced by "______" (six underscores).'),answer:n.z.string().describe("The word that was removed from the sentence.")}),m=n.z.union([d,u,p]),h=n.z.object({topic:n.z.string().describe('A comma-separated list of science topics to generate questions for, e.g., "B1: Cell Biology, B4: Bioenergetics"'),difficulty:n.z.enum(["easy","medium","hard"]).describe("The difficulty level of the questions."),performanceSummary:n.z.string().describe("A summary of the user performance on previous quizzes and revision activities, including areas of weakness."),questionCount:n.z.number().int().min(1).max(10).default(10).describe("The number of questions to generate.")}),x=n.z.object({questions:n.z.array(m).describe("An array of practice questions.")});async function l(e){return g(e)}let f=a.ai.definePrompt({name:"practiceQuestionPrompt",input:{schema:h},output:{schema:x},prompt:`You are an expert AQA GCSE Science examiner. Your task is to create a practice exam paper.
You MUST generate {{questionCount}} practice questions on the following topics: {{topic}}.
The difficulty of the paper should be {{difficulty}}.

Crucially, the questions you generate should be based on the style and content of real past AQA GCSE exam papers.

You MUST generate a mix of different question types. Include 'multiple-choice', 'written-question' and 'fill-in-the-gaps' questions to create a varied mock exam paper.
Ensure some of the written questions are for higher marks (4-6 marks) to properly challenge the student.

The user has provided the following context, but you should prioritize generating questions based on the selected topics:
User Context: {{{performanceSummary}}}
`}),g=a.ai.defineFlow({name:"generatePracticeQuestionsFlow",inputSchema:h,outputSchema:x},async e=>{let t=0;for(;t<=2;)try{let{output:t}=await f(e);if(!t)throw Error("Generated practice questions output was empty.");return t}catch(e){if(429===e.status||503===e.status){if(++t>2)throw e;await new Promise(e=>setTimeout(e,1e3*t))}else throw e}throw Error("Failed to generate practice questions after multiple retries.")});(0,o.D)([l]),(0,i.A)(l,"4021e8d75d579c67e7280e1e9c68558336e65fa1cd",null),s()}catch(e){s(e)}})},73496:e=>{"use strict";e.exports=require("http2")},73566:e=>{"use strict";e.exports=require("worker_threads")},74075:e=>{"use strict";e.exports=require("zlib")},74998:e=>{"use strict";e.exports=require("perf_hooks")},76973:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{P:()=>l});var i=r(91199);r(42087);var a=r(95427),n=r(37612),o=r(33331),c=e([a]);a=(c.then?(await c)():c)[0];let d=n.z.object({question:n.z.string().describe("The exam question that was asked."),marks:n.z.number().describe("The number of marks the question is worth."),userAnswer:n.z.string().describe("The student's answer to the question."),markScheme:n.z.string().describe("The detailed mark scheme or model answer for the question.")}),u=n.z.object({feedback:n.z.string().describe("Detailed, constructive feedback for the student. It should be formatted as HTML and explain which marking points were hit and which were missed."),marksAwarded:n.z.number().describe("The number of marks awarded for the answer.")});async function l(e){return m(e)}let p=a.ai.definePrompt({name:"gradeWrittenAnswerPrompt",input:{schema:d},output:{schema:u},prompt:`You are an expert AQA GCSE Science examiner with a friendly and encouraging tone. Your task is to mark a student's answer against the provided mark scheme.

You must provide detailed, constructive feedback formatted in HTML. Do not just say if the answer is right or wrong. Explain *why*.

Your feedback should follow this structure:
1.  Start with a positive and encouraging opening.
2.  Create a <ul> list. For each point in the mark scheme, create a <li>.
3.  Inside each <li>, state the marking point. Then, say whether the student's answer achieved this point. Use a "✅" emoji if they got the point and a "❌" if they missed it.
4.  Provide a brief quote or explanation of why they did or did not get the mark.
5.  After the list, provide a summary of how they could improve.
6.  Finally, determine the total marks awarded.

Example response for a 2-mark question:
"<p>Great effort! Here's a breakdown of your answer:</p>
<ul>
    <li>✅ <strong>Marking Point:</strong> The student correctly identified that enzymes act as catalysts. <strong>Your Answer:</strong> You mentioned that 'enzymes speed up reactions', which is a perfect way to put it.</li>
    <li>❌ <strong>Marking Point:</strong> The student did not mention that enzymes are proteins. <strong>Your Answer:</strong> You explained what enzymes do, but didn't mention what they are made of.</li>
</ul>
<p><strong>To improve:</strong> Next time, remember to also state that enzymes are a type of protein to secure that second mark. Well done on the first point!</p>"

Here is the information:
Question: "{{{question}}}"
Marks available: {{{marks}}}
Mark Scheme: "{{{markScheme}}}"
Student's Answer: "{{{userAnswer}}}"
`}),m=a.ai.defineFlow({name:"gradeWrittenAnswerFlow",inputSchema:d,outputSchema:u},async e=>{let t=0;for(;t<=2;)try{let{output:t}=await p(e);if(!t)throw Error("Generated grading output was empty.");return t}catch(e){if(429===e.status||503===e.status){if(++t>2)throw e;await new Promise(e=>setTimeout(e,1e3*t))}else throw e}throw Error("Failed to grade answer after multiple retries.")});(0,o.D)([l]),(0,i.A)(l,"4009aad1f8b392364694d77d5e9bb97a4a714cbbb9",null),s()}catch(e){s(e)}})},77030:e=>{"use strict";e.exports=require("node:net")},77598:e=>{"use strict";e.exports=require("node:crypto")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},79646:e=>{"use strict";e.exports=require("child_process")},79748:e=>{"use strict";e.exports=require("fs/promises")},80013:(e,t,r)=>{"use strict";r.d(t,{J:()=>l});var s=r(60687),i=r(43210),a=r(78148),n=r(24224),o=r(4780);let c=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=i.forwardRef(({className:e,...t},r)=>(0,s.jsx)(a.b,{ref:r,className:(0,o.cn)(c(),e),...t}));l.displayName=a.b.displayName},81630:e=>{"use strict";e.exports=require("http")},84297:e=>{"use strict";e.exports=require("async_hooks")},91645:e=>{"use strict";e.exports=require("net")},91821:(e,t,r)=>{"use strict";r.d(t,{Fc:()=>c,TN:()=>d,XL:()=>l});var s=r(60687),i=r(43210),a=r(24224),n=r(4780);let o=(0,a.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=i.forwardRef(({className:e,variant:t,...r},i)=>(0,s.jsx)("div",{ref:i,role:"alert",className:(0,n.cn)(o({variant:t}),e),...r}));c.displayName="Alert";let l=i.forwardRef(({className:e,...t},r)=>(0,s.jsx)("h5",{ref:r,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",e),...t}));l.displayName="AlertTitle";let d=i.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",e),...t}));d.displayName="AlertDescription"},94735:e=>{"use strict";e.exports=require("events")},97294:(e,t,r)=>{Promise.resolve().then(r.bind(r,26428))}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,828,658,247,185,774,802],()=>r(57493));module.exports=s})();